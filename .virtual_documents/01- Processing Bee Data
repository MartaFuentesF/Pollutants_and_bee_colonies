


# imports
import pandas as pd
import os
import pandas as pd





directory = '../Project_4/Data_Bees/processed_dfs/'
os.makedirs(directory, exist_ok = True)





# Creating the function
def process_data(file): # year data is in the format 2007-08
    
    file = str(file) 
    dfs = [] #store each data frame, for concatenation

    file_for_import = f'../Project_4/Data_Bees/{file}.xlsx'
    sheet_names = pd.ExcelFile(file_for_import).sheet_names #see citation
    
    for sheet_name in sheet_names:
        df = pd.read_excel(file_for_import, sheet_name = sheet_name)
        df['year'] = str(sheet_name[0:4]) #make a column for the year
        dfs.append(df) #append df to the list for concatenation

    #concatenate
    df_combo = pd.concat(dfs, ignore_index = True)

    return df_combo

# saving the output df as a variable
colony_loss_df = process_data('BIP Bee Colony Loss Clean')


colony_loss_df.head()


# saving to .csv
colony_loss_df.to_csv(directory + 'bip_colony_loss_processed')





df_2 = pd.read_csv('./Data_Bees/Bee Colony Census Data by County.csv')
df_2.head(30)


df_2.describe()


df_2.info()


df_2.isna().sum()





# some entries in the Value columns are not numbers
df_2['Value'].value_counts()





# Integers to Objects
cols_int_to_object = ['State ANSI', 'Ag District Code', 'County ANSI']

for col in cols_int_to_object:
    df_2[col] = df_2[col].astype(object)

# Objects to Integers

df_2['Value'] = df_2['Value'].astype(int)



